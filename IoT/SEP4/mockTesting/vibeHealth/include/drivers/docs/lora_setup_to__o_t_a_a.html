<!-- HTML header for doxygen 1.8.20-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IoT Drivers: OTAA setup steps</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/wavedrom/2.6.8/skins/default.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/wavedrom/2.6.8/wavedrom.min.js" type="text/javascript"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body onload="WaveDrom.ProcessAll()">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IoT Drivers
   &#160;<span id="projectnumber">v3.3.0 (S2022)</span>
   </div>
   <div id="projectbrief">Engineering in Software Technology</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('lora_setup_to__o_t_a_a.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">OTAA setup steps </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section note"><dt>Note</dt><dd>All the following code must be implemented in the initialisation part of a FreeRTOS task! </dd>
<dd>
Nearly all calls to the driver will suspend the calling task while the driver waits for response from the RN2484 module.</dd></dl>
<h1><a class="anchor" id="lora_basic_use_case_setupOTAA_code"></a>
Example code</h1>
<p>In this use case, the driver is setup to Over The Air Activation (OTAA).</p>
<h1><a class="anchor" id="lora_setup_use_case_OTAA_setup_flow"></a>
Workflow</h1>
<ol type="1">
<li>Define the necessary app identification for OTAA join: <div class="fragment"><div class="line"><span class="comment">// Parameters for OTAA join</span></div>
<div class="line"><span class="preprocessor">#define LORA_appEUI &quot;????????????????&quot;</span></div>
<div class="line"><span class="preprocessor">#define LORA_appKEY &quot;????????????????????????????????&quot;</span></div>
</div><!-- fragment --></li>
</ol>
<dl class="section note"><dt>Note</dt><dd>The parameters depends on the setup of the LoRaWAN network server and will be given to you.</dd></dl>
<ol type="1">
<li>Set the module to factory set defaults: <div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__lora__basic__function.html#ga614b0764c3700d0d948fadb9cebc5454">lora_driver_rn2483FactoryReset</a>() != <a class="code" href="group__lora__driver__return__codes.html#ggae8873a4b0283525974b1dcab1a039f15a4b55d0da89bdc2f9bd3dfb86854f055a">LORA_OK</a>)</div>
<div class="line">{</div>
<div class="line">       <span class="comment">// Something went wrong</span></div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>Configure the module to use the EU868 frequency plan and settings: <div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__lora__basic__function.html#ga88a60dca5281f2b4aebd01c0445478f2">lora_driver_configureToEu868</a>() != <a class="code" href="group__lora__driver__return__codes.html#ggae8873a4b0283525974b1dcab1a039f15a4b55d0da89bdc2f9bd3dfb86854f055a">LORA_OK</a>)</div>
<div class="line">{</div>
<div class="line">       <span class="comment">// Something went wrong</span></div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>Get the RN2483 modules unique devEUI: <div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> devEui[17]; <span class="comment">// It is static to avoid it to occupy stack space in the task</span></div>
<div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__lora__basic__function.html#gaa14be250cb18d3a633629f29c03fcabd">lora_driver_getRn2483Hweui</a>(devEui) != <a class="code" href="group__lora__driver__return__codes.html#ggae8873a4b0283525974b1dcab1a039f15a4b55d0da89bdc2f9bd3dfb86854f055a">LORA_OK</a>)</div>
<div class="line">{</div>
<div class="line">       <span class="comment">// Something went wrong</span></div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>Set the necessary LoRaWAN parameters for an OTAA join: <div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__lora__basic__function.html#ga69e8adcdd900fdb4dfae1780c79a602d">lora_driver_setOtaaIdentity</a>(LORA_appEUI,LORA_appKEY,devEui) != <a class="code" href="group__lora__driver__return__codes.html#ggae8873a4b0283525974b1dcab1a039f15a4b55d0da89bdc2f9bd3dfb86854f055a">LORA_OK</a>)</div>
<div class="line">{</div>
<div class="line">       <span class="comment">// Something went wrong</span></div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>Save all set parameters to the RN2483 modules EEPROM (OPTIONAL STEP): <dl class="section note"><dt>Note</dt><dd>If this step is performed then it is no necessary to do the steps above more than once. These parameters will automatically be restored in the module on next reset or power on.</dd></dl>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__lora__basic__function.html#ga3b0f0b2ff07645d806afdfa7d240a45a">lora_driver_saveMac</a>() != <a class="code" href="group__lora__driver__return__codes.html#ggae8873a4b0283525974b1dcab1a039f15a4b55d0da89bdc2f9bd3dfb86854f055a">LORA_OK</a>)</div>
<div class="line">{</div>
<div class="line">       <span class="comment">// Something went wrong</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// All parameters are now saved in the module</span></div>
</div><!-- fragment --></li>
<li>Join LoRaWAN parameters with OTAA: <div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__lora__basic__function.html#ga8a017a740222cdf44b161b152877b771">lora_driver_join</a>(<a class="code" href="group__lora__config.html#gga1496512da4a01e52802d5bab67db26fda293faf6e8359b88e131edcee7c905041">LORA_OTAA</a>) == <a class="code" href="group__lora__driver__return__codes.html#ggae8873a4b0283525974b1dcab1a039f15a14368da1f090e33d76949cbccb3b94bc">LORA_ACCEPTED</a>)</div>
<div class="line">{</div>
<div class="line">       <span class="comment">// You are now joined</span></div>
<div class="line">}</div>
</div><!-- fragment --> </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="agroup__lora__basic__function_html_ga8a017a740222cdf44b161b152877b771"><div class="ttname"><a href="group__lora__basic__function.html#ga8a017a740222cdf44b161b152877b771">lora_driver_join</a></div><div class="ttdeci">lora_driver_returnCode_t lora_driver_join(lora_driver_joinMode_t mode)</div><div class="ttdoc">Joins a LoRaWAN either with ABP or OTAA.</div></div>
<div class="ttc" id="agroup__lora__basic__function_html_ga88a60dca5281f2b4aebd01c0445478f2"><div class="ttname"><a href="group__lora__basic__function.html#ga88a60dca5281f2b4aebd01c0445478f2">lora_driver_configureToEu868</a></div><div class="ttdeci">lora_driver_returnCode_t lora_driver_configureToEu868(void)</div><div class="ttdoc">Set the driver up to using EU868 standard.</div></div>
<div class="ttc" id="agroup__lora__basic__function_html_gaa14be250cb18d3a633629f29c03fcabd"><div class="ttname"><a href="group__lora__basic__function.html#gaa14be250cb18d3a633629f29c03fcabd">lora_driver_getRn2483Hweui</a></div><div class="ttdeci">lora_driver_returnCode_t lora_driver_getRn2483Hweui(char hwDevEUI[17])</div><div class="ttdoc">Get the RN2483 factory set devEUI.</div></div>
<div class="ttc" id="agroup__lora__driver__return__codes_html_ggae8873a4b0283525974b1dcab1a039f15a4b55d0da89bdc2f9bd3dfb86854f055a"><div class="ttname"><a href="group__lora__driver__return__codes.html#ggae8873a4b0283525974b1dcab1a039f15a4b55d0da89bdc2f9bd3dfb86854f055a">LORA_OK</a></div><div class="ttdeci">@ LORA_OK</div><div class="ttdef"><b>Definition:</b> lora_driver.h:66</div></div>
<div class="ttc" id="agroup__lora__config_html_gga1496512da4a01e52802d5bab67db26fda293faf6e8359b88e131edcee7c905041"><div class="ttname"><a href="group__lora__config.html#gga1496512da4a01e52802d5bab67db26fda293faf6e8359b88e131edcee7c905041">LORA_OTAA</a></div><div class="ttdeci">@ LORA_OTAA</div><div class="ttdef"><b>Definition:</b> lora_driver.h:94</div></div>
<div class="ttc" id="agroup__lora__basic__function_html_ga69e8adcdd900fdb4dfae1780c79a602d"><div class="ttname"><a href="group__lora__basic__function.html#ga69e8adcdd900fdb4dfae1780c79a602d">lora_driver_setOtaaIdentity</a></div><div class="ttdeci">lora_driver_returnCode_t lora_driver_setOtaaIdentity(char appEUI[17], char appKEY[33], char devEUI[17])</div><div class="ttdoc">Set identifiers and keys for a OTAA join.</div></div>
<div class="ttc" id="agroup__lora__basic__function_html_ga3b0f0b2ff07645d806afdfa7d240a45a"><div class="ttname"><a href="group__lora__basic__function.html#ga3b0f0b2ff07645d806afdfa7d240a45a">lora_driver_saveMac</a></div><div class="ttdeci">lora_driver_returnCode_t lora_driver_saveMac(void)</div><div class="ttdoc">Save the set parameters into the EEPROM of the RN2483 module.</div></div>
<div class="ttc" id="agroup__lora__driver__return__codes_html_ggae8873a4b0283525974b1dcab1a039f15a14368da1f090e33d76949cbccb3b94bc"><div class="ttname"><a href="group__lora__driver__return__codes.html#ggae8873a4b0283525974b1dcab1a039f15a14368da1f090e33d76949cbccb3b94bc">LORA_ACCEPTED</a></div><div class="ttdeci">@ LORA_ACCEPTED</div><div class="ttdef"><b>Definition:</b> lora_driver.h:75</div></div>
<div class="ttc" id="agroup__lora__basic__function_html_ga614b0764c3700d0d948fadb9cebc5454"><div class="ttname"><a href="group__lora__basic__function.html#ga614b0764c3700d0d948fadb9cebc5454">lora_driver_rn2483FactoryReset</a></div><div class="ttdeci">lora_driver_returnCode_t lora_driver_rn2483FactoryReset(void)</div><div class="ttdoc">Reset the RN2483 module.</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="lora_driver_quickstart.html">Quick start guide for RN2483 based LoRa Driver</a></li>
    <li class="footer">Generated on Mon Apr 4 2022 15:25:11 for IoT Drivers by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
